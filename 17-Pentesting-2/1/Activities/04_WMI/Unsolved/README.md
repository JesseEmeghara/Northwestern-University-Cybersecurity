## Activity File: WMI

In this activity, you'll continue to play the role of a pentester conducting an engagement on MegaCorpOne. Now that you have two sets of credentials, you'll leverage these credentials and use a Metasploit module in order to run commands on the remote machine.

- You'll be provided instructions to use this module to gather information on your target machine.

⚠️ **Reminder** - Don't forget to save your findings, as you will add them to your week 17 Homework!


### Instructions

1. In Kali, open a terminal and start Metasploit (if not already started), then load the `scanner/smb/impacket/wmiexec` module.

2. View the options for the module, and set the RHOSTS, SMBDomain, SMBPass, and SMBUser fields to the target IP and credentials that you verified from password spraying.

3. Set the COMMAND parameter to "whoami."

4. Run the module. You should see the output "megacorpone\tstark."

	 - **Note:** If your command times out, try to ping the Windows 10 machine from your Kali machine via command `ping 172.22.117.20`. If you do not get a ping back, have your instructor restart your host machine. 

5. Change the COMMAND parameter to list the processes. 

     - **Hint:** WMI uses MS-DOS commands, not PowerShell. If you're stuck, look up how to list processes in MS-DOS.

6. Using other commands, answer the following questions:

	1. What is the version and build number of Windows?
	
	2. What processor architecture is the machine?
	
	3. Are there any users logged in?
	
	4. What shares are available on the machine?

---

&copy; 2023 edX Boot Camps LLC. Confidential and Proprietary. All Rights Reserved.



